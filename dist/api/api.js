"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,s){try{var u=t[o](s),i=u.value}catch(e){return void n(e)}if(!u.done)return Promise.resolve(i).then(function(e){r("next",e)},function(e){r("throw",e)});e(i)}return r("next")})}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.optionsRole=exports.getDevieList=exports.getDeptUserList=exports.getOperlog=exports.getParentDeptUser=exports.userChangeStatus=exports.getMyInfo=exports.getUserByDept=exports.deviceOptions=exports.warnOptions=exports.warnList=exports.getWarningInfo=exports.updateWarning=exports.addWarning=exports.bindDept=exports.updateUser=exports.userLogout=exports.getUserInfo=exports.wechatByPhone=exports.decryptPhone=exports.wechatLogin=exports.getOpenid=exports.smsLogin=exports.getCode=void 0;var _wepy=require("./../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_wepyRedux=require("./../npm/wepy-redux/lib/index.js"),_tip=require("./../utils/tip.js"),_tip2=_interopRequireDefault(_tip),_qs=require("./../npm/qs/lib/index.js"),_qs2=_interopRequireDefault(_qs),wxRequest=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n,r,o,s,u,i,p,a,g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},x=arguments[1],c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",d=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d&&_tip2.default.loading(),t={},t["content-type"]="PUT"==c?"application/json":"application/x-www-form-urlencoded",n=(0,_wepyRedux.getStore)(),r=n.getState().user.globalData,o=wx.getStorageSync("token"),o&&(t.Authorization=o),s=_wepy2.default.$instance.globalData.env,"prod"==s?x="https://tcb-api.tencentcloudapi.com"+x:"test"==s&&(x="https://beidou.signalfire.net.cn/"+x),u="POST"==c?_qs2.default.stringify(g):g,e.next=12,_wepy2.default.request({header:t,url:x,method:c,data:u}).catch(function(e){console.log("wepy requerst err:"+e)});case 12:if(i=e.sent,d&&_tip2.default.loaded(),!i||!i.data){e.next=19;break}return p=i.data,401==p.code&&(a=wx.getStorageSync("token"),a&&wx.removeStorageSync("token"),setTimeout(function(){wx.navigateTo({url:"/pages/login"})},1e3)),500==p.code&&p.msg&&wx.showToast({title:p.msg,icon:"none",duration:1500}),e.abrupt("return",i.data);case 19:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),getCode=exports.getCode=function(e){return wxRequest(e,"smscode","GET")},smsLogin=exports.smsLogin=function(e){return wxRequest(e,"smslogin")},getOpenid=exports.getOpenid=function(e){return wxRequest(e,"getOpenid")},wechatLogin=exports.wechatLogin=function(e){return wxRequest(e,"wechatlogin")},decryptPhone=exports.decryptPhone=function(e){return wxRequest(e,"decryptWeChatPhoneNumber")},wechatByPhone=exports.wechatByPhone=function(e){return wxRequest(e,"wetChatLoginByPhoneNumber")},getUserInfo=exports.getUserInfo=function(){return wxRequest({},"getInfo","GET")},userLogout=exports.userLogout=function(){return wxRequest({},"logout")},updateUser=exports.updateUser=function(e){return wxRequest(e,"system/user/profile","PUT")},bindDept=exports.bindDept=function(e){return wxRequest(e,"system/user/profile/bindDept","PUT")},addWarning=exports.addWarning=function(e){return wxRequest(e,"yujing/add","PUT")},updateWarning=exports.updateWarning=function(e){return wxRequest(e,"yujing/edit","PUT")},getWarningInfo=exports.getWarningInfo=function(e){return wxRequest({},"yujing/getInfoByAuthorization/"+e.yuJingId,"GET")},warnList=exports.warnList=function(e){return wxRequest(e,"yujing/list2","GET")},warnOptions=exports.warnOptions=function(e){return wxRequest(e,"yujing/optionselect","GET")},deviceOptions=exports.deviceOptions=function(e){return wxRequest(e,"device/optionselect","GET")},getUserByDept=exports.getUserByDept=function(){return wxRequest({},"system/user/getMy","GET")},getMyInfo=exports.getMyInfo=function(){return wxRequest({},"system/user/getMyInfo","GET")},userChangeStatus=exports.userChangeStatus=function(e){return wxRequest(e,"system/user/userDeviceChangeStatus","PUT")},getParentDeptUser=exports.getParentDeptUser=function(){return wxRequest({},"system/user/getpParentDeptUserlist","GET")},getOperlog=exports.getOperlog=function(e){return wxRequest(e,"monitor/operlog/list","GET")},getDeptUserList=exports.getDeptUserList=function(e){return wxRequest(e,"system/user/getMyDeptUserList","GET")},getDevieList=exports.getDevieList=function(e){return wxRequest(e,"system/user/getMyDeviceList","GET")},optionsRole=exports.optionsRole=function(e){return wxRequest(e,"system/role/optionselectForApp","GET")};